const _={},k=Object.freeze(Object.defineProperty({__proto__:null,default:_},Symbol.toStringTag,{value:"Module"})),{env:s={},argv:O=[],platform:T=""}=typeof process>"u"?{}:process,$="NO_COLOR"in s||O.includes("--no-color"),I="FORCE_COLOR"in s||O.includes("--color"),R=T==="win32",x=s.TERM==="dumb",D=k&&void 0,M="CI"in s&&("GITHUB_ACTIONS"in s||"GITLAB_CI"in s||"CIRCLECI"in s),N=!$&&(I||R&&!x||D||M),j=(t,n,r,o,i=n.substring(0,t)+o,h=n.substring(t+r.length),l=h.indexOf(r))=>i+(l<0?h:j(l,h,r,o)),P=(t,n,r,o,i)=>t<0?r+n+o:r+j(t,n,o,i)+o,A=(t,n,r=t,o=t.length+1)=>i=>i||!(i===""||i===void 0)?P((""+i).indexOf(n,o),i,t,n,r):"",e=(t,n,r)=>A(`\x1B[${t}m`,`\x1B[${n}m`,r),w={reset:e(0,0),bold:e(1,22,"\x1B[22m\x1B[1m"),dim:e(2,22,"\x1B[22m\x1B[2m"),italic:e(3,23),underline:e(4,24),inverse:e(7,27),hidden:e(8,28),strikethrough:e(9,29),black:e(30,39),red:e(31,39),green:e(32,39),yellow:e(33,39),blue:e(34,39),magenta:e(35,39),cyan:e(36,39),white:e(37,39),gray:e(90,39),bgBlack:e(40,49),bgRed:e(41,49),bgGreen:e(42,49),bgYellow:e(43,49),bgBlue:e(44,49),bgMagenta:e(45,49),bgCyan:e(46,49),bgWhite:e(47,49),blackBright:e(90,39),redBright:e(91,39),greenBright:e(92,39),yellowBright:e(93,39),blueBright:e(94,39),magentaBright:e(95,39),cyanBright:e(96,39),whiteBright:e(97,39),bgBlackBright:e(100,49),bgRedBright:e(101,49),bgGreenBright:e(102,49),bgYellowBright:e(103,49),bgBlueBright:e(104,49),bgMagentaBright:e(105,49),bgCyanBright:e(106,49),bgWhiteBright:e(107,49)},G=({useColor:t=N}={})=>t?w:Object.keys(w).reduce((n,r)=>({...n,[r]:String}),{}),{reset:z,bold:H,dim:X,italic:J,underline:K,inverse:Q,hidden:Z,strikethrough:ee,black:te,red:ne,green:re,yellow:oe,blue:ie,magenta:ae,cyan:ce,white:se,gray:le,bgBlack:de,bgRed:ge,bgGreen:he,bgYellow:be,bgBlue:ue,bgMagenta:me,bgCyan:pe,bgWhite:ye,blackBright:Be,redBright:fe,greenBright:Ce,yellowBright:ve,blueBright:we,magentaBright:W,cyanBright:Ee,whiteBright:Se,bgBlackBright:Oe,bgRedBright:je,bgGreenBright:Le,bgYellowBright:_e,bgBlueBright:ke,bgMagentaBright:Te,bgCyanBright:$e,bgWhiteBright:Ie}=G(),m=`[${W("Niinaryve")}]`,q="nnryv-app",C=["nnryv-name-base","nnryv-name-member","nnryv-name-moderator"],L={"nnryv-name-base":"#7fffd4","nnryv-name-member":"#2ba640","nnryv-name-moderator":"#5e84f1"},U=C.map(t=>({name:t,defaultValue:L[t]}));function E(t,n){const r=n??document.body;return new Promise(o=>{if(r.querySelector(t))return o(r.querySelector(t));const i=new MutationObserver(()=>{r.querySelector(t)&&(o(r.querySelector(t)),i.disconnect())});i.observe(r,{childList:!0,subtree:!0})})}console.log(`${m} extension loaded`);const F="nnryv-injected",g=t=>t.classList.add(F),S=(t,n,r)=>{t.style.setProperty(`--${n}`,r)},V=({injectedCSSUrl:t,injectedJSUrl:n,openCSSUrl:r,openJSUrl:o})=>{document.addEventListener("DOMContentLoaded",async()=>{const i=document.querySelector(":root"),h=await chrome.storage.sync.get(C);for(const{name:c,defaultValue:d}of U)S(i,c,h[c]??d);console.log(`${m} Waiting chat app`);const l=await E("body > yt-live-chat-app");console.log(`${m} Chat app found`);const v=l.ownerDocument,p=v.head||v.documentElement,y=document.createElement("div");y.id=q,y.classList.add("hide"),g(y),l.appendChild(y),E("yt-live-chat-button",l).then(async c=>{const d=document.createElement("div");d.id="nnryv-open",g(d),c.prepend(d);const a=document.createElement("link");a.rel="stylesheet",a.href=r,g(a),p.appendChild(a);const u=document.createElement("script");u.src=o,u.type="module",u.setAttribute("extension_origin",o),g(u),p.appendChild(u)});const B=document.createElement("link");B.rel="stylesheet",B.href=t,g(B),p.appendChild(B);const b=document.createElement("script");b.src=n,b.type="module",b.setAttribute("extension_origin",n),g(b),p.appendChild(b),console.log(`${m} Done injecting script`),console.log(`${m} Listen to event`),chrome.storage.onChanged.addListener((c,d)=>{for(const a of C)c[a]&&S(i,a,c[a].newValue??L[a])})})},f=(t,n,r,o)=>`https://cdn.jsdelivr.net/gh/TzeroOcne/Niinaryve@${o}/dist/${n}/${t}.${r}`,Y="https://api.github.com/repos/TzeroOcne/Niinaryve/tags?per_page=1";(async()=>{const t=await(await fetch(Y)).json();if(t.length===0)throw Error("cannot found latest tag");const[{name:n}]=t;V({injectedCSSUrl:f("injected","runner","css",n),injectedJSUrl:f("injected","runner","js",n),openCSSUrl:f("open","app","css",n),openJSUrl:f("open","app","js",n)})})();

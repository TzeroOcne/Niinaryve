const O={},C=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"})),{env:l={},argv:x=[],platform:E=""}=typeof process>"u"?{}:process,M="NO_COLOR"in l||x.includes("--no-color"),_="FORCE_COLOR"in l||x.includes("--color"),S=E==="win32",$=l.TERM==="dumb",k=C&&void 0,L="CI"in l&&("GITHUB_ACTIONS"in l||"GITLAB_CI"in l||"CIRCLECI"in l),N=!M&&(_||S&&!$||k||L),T=(e,i,r,n,s=i.substring(0,e)+n,c=i.substring(e+r.length),a=c.indexOf(r))=>s+(a<0?c:T(a,c,r,n)),P=(e,i,r,n,s)=>e<0?r+i+n:r+T(e,i,n,s)+n,j=(e,i,r=e,n=e.length+1)=>s=>s||!(s===""||s===void 0)?P((""+s).indexOf(i,n),s,e,i,r):"",t=(e,i,r)=>j(`\x1B[${e}m`,`\x1B[${i}m`,r),R={reset:t(0,0),bold:t(1,22,"\x1B[22m\x1B[1m"),dim:t(2,22,"\x1B[22m\x1B[2m"),italic:t(3,23),underline:t(4,24),inverse:t(7,27),hidden:t(8,28),strikethrough:t(9,29),black:t(30,39),red:t(31,39),green:t(32,39),yellow:t(33,39),blue:t(34,39),magenta:t(35,39),cyan:t(36,39),white:t(37,39),gray:t(90,39),bgBlack:t(40,49),bgRed:t(41,49),bgGreen:t(42,49),bgYellow:t(43,49),bgBlue:t(44,49),bgMagenta:t(45,49),bgCyan:t(46,49),bgWhite:t(47,49),blackBright:t(90,39),redBright:t(91,39),greenBright:t(92,39),yellowBright:t(93,39),blueBright:t(94,39),magentaBright:t(95,39),cyanBright:t(96,39),whiteBright:t(97,39),bgBlackBright:t(100,49),bgRedBright:t(101,49),bgGreenBright:t(102,49),bgYellowBright:t(103,49),bgBlueBright:t(104,49),bgMagentaBright:t(105,49),bgCyanBright:t(106,49),bgWhiteBright:t(107,49)},G=({useColor:e=N}={})=>e?R:Object.keys(R).reduce((i,r)=>({...i,[r]:String}),{}),{reset:Z,bold:D,dim:I,italic:A,underline:ee,inverse:te,hidden:ne,strikethrough:re,black:ie,red:oe,green:se,yellow:ce,blue:ae,magenta:ge,cyan:le,white:be,gray:ue,bgBlack:he,bgRed:de,bgGreen:me,bgYellow:Be,bgBlue:fe,bgMagenta:ye,bgCyan:pe,bgWhite:we,blackBright:Re,redBright:ve,greenBright:xe,yellowBright:Te,blueBright:Oe,magentaBright:W,cyanBright:Ce,whiteBright:Ee,bgBlackBright:Me,bgRedBright:_e,bgGreenBright:Se,bgYellowBright:$e,bgBlueBright:ke,bgMagentaBright:Le,bgCyanBright:Ne,bgWhiteBright:Pe}=G(),m=`[${W("Niinaryve")}]`,q="nnryv-app";function f(e,i){const r=i??document.body;return new Promise(n=>{if(r.querySelector(e))return n(r.querySelector(e));const s=new MutationObserver(()=>{r.querySelector(e)&&(n(r.querySelector(e)),s.disconnect())});s.observe(r,{childList:!0,subtree:!0})})}const{fetch:F}=window;let y;const Y=/member/i,z=/moderator/i,H=/verified/i,p=(e=[],i)=>e.length===0?!1:e.filter(({liveChatAuthorBadgeRenderer:n})=>n).map(({liveChatAuthorBadgeRenderer:n})=>n).filter(({tooltip:n})=>n).map(({tooltip:n})=>n).filter(n=>i.test(n)).length>0,J=(e=[])=>p(e,Y),U=(e=[])=>p(e,z),V=(e=[])=>p(e,H),X=e=>{const i=[];return J(e)&&i.push("member"),U(e)&&i.push("moderator"),V(e)&&i.push("verified"),i},K=async(e,i,r)=>{const n=await f(`#${e.replace(/%/g,"\\%")} span#author-name:not(.ytc-marked)`);n.classList.add("nnryv-marked");const s=document.createElement("a");s.href=`/channel/${i}`,s.innerText=n.textContent;const c=document.createElement("span");c.appendChild(s),c.classList.add("nnryv-verifier");for(const a of r)c.classList.add(a);for(const a of n.childNodes)n.removeChild(a);n.appendChild(c)},Q=(e,i)=>{const{actions:r}=i;return r?e.concat(...r):e.concat(i)},v=async(e,i)=>{var a,w;const r=((a=e==null?void 0:e.contents)==null?void 0:a.liveChatRenderer)??((w=e==null?void 0:e.continuationContents)==null?void 0:w.liveChatContinuation);if(!r)return;const{actions:n}=r,c=((n??[]).map(o=>o.replayChatItemAction?o.replayChatItemAction:o).reduce(Q,[])??[]).map(({addChatItemAction:o,addLiveChatTickerItemAction:g})=>{var u,h,d,B;const b=((u=o==null?void 0:o.item)==null?void 0:u.liveChatTextMessageRenderer)??((h=o==null?void 0:o.item)==null?void 0:h.liveChatPaidMessageRenderer)??((d=g==null?void 0:g.item)==null?void 0:d.liveChatTickerSponsorItemRenderer);return b&&{renderer:b,paid:!!((B=o==null?void 0:o.item)!=null&&B.liveChatTextMessageRenderer)}}).filter(o=>o).map(({renderer:o,paid:g})=>{const{authorName:b,authorExternalChannelId:u,id:h,authorBadges:d,authorPhoto:B}=o;return{authorName:b,authorExternalChannelId:u,authorBadges:d,id:h,paid:g}});y&&i&&(console.log(`${m} Dispatching chat init event`),y.dispatchEvent(new CustomEvent("livechat",{detail:c})));for(const{id:o,authorExternalChannelId:g,authorBadges:b}of c)await K(o,g,X(b))};(async()=>(y=await f(`div#${q}`),console.log(`${m} Modify Init`),f("body>script:not([src])").then(async e=>{const r=e.text.replace(/^(.*?) = /,"").replace(/;*$/,""),n=JSON.parse(r);v(n,"init")}),console.log(`${m} Injecting fetch Capture`),window.fetch=async(e,i)=>{const r=await F(e,i);if(e instanceof Request&&e.method==="POST"&&e.url.startsWith("https://www.youtube.com/youtubei/v1/live_chat/get_live_chat")){const n=r.clone();setTimeout(async()=>{await v(await n.json())},0)}return r},console.log(`${m} Done injecting fetch Capture`)))();
